# 1.æ¦‚ç‡åŸºç¡€

**è”åˆæ¦‚ç‡**ï¼šåŒ…å«å¤šä¸ªæ¡ä»¶ï¼Œä¸”æ‰€æœ‰æ¡ä»¶åŒæ—¶æˆç«‹çš„æ¦‚ç‡

è®°ä½œ ğ‘ƒ(ğ´,ğµ)  ã€ P(AB) ã€ P(Aâˆ©B)ï¼šğ‘ƒ(ğ´,ğµ) = P(A) * P(B)

**æ¡ä»¶æ¦‚ç‡**ï¼šå°±æ˜¯äº‹ä»¶Aåœ¨å¦å¤–ä¸€ä¸ªäº‹ä»¶Bå·²ç»å‘ç”Ÿæ¡ä»¶ä¸‹çš„å‘ç”Ÿæ¦‚ç‡

è®°ä½œï¼šğ‘ƒ(ğ´|ğµ) = P(A,B) / P(B)

**ç‰¹æ€§**ï¼šP(A1,A2|B) = P(A1|B)P(A2|B)
æ³¨æ„ï¼šæ­¤æ¡ä»¶æ¦‚ç‡çš„æˆç«‹ï¼Œæ˜¯ç”±äºA1,A2ç›¸äº’ç‹¬ç«‹çš„ç»“æœ

# 2.ç®—æ³•åŸç†

æœ´ç´ è´å¶æ–¯-è´å¶æ–¯å…¬å¼

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815111608671-1586431802.png)

æ³¨ï¼šwä¸ºç»™å®šæ–‡æ¡£çš„ç‰¹å¾å€¼(é¢‘æ•°ç»Ÿè®¡,é¢„æµ‹æ–‡æ¡£æä¾›)ï¼Œcä¸ºæ–‡æ¡£ç±»åˆ«ã€‚
å…¬å¼å¯ä»¥ç†è§£ä¸ºï¼š

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815111704799-266067737.png)

å…¶ä¸­cå¯ä»¥æ˜¯ä¸åŒç±»åˆ«ã€‚

å…¬å¼åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š

- - ğ‘ƒ(ğ¶)ï¼šæ¯ä¸ªæ–‡æ¡£ç±»åˆ«çš„æ¦‚ç‡(æŸæ–‡æ¡£ç±»åˆ«è¯æ•°ï¼æ€»æ–‡æ¡£è¯æ•°)ã€‚
  - ğ‘ƒ(ğ‘Šâ”‚ğ¶)ï¼šç»™å®šç±»åˆ«ä¸‹ç‰¹å¾ï¼ˆè¢«é¢„æµ‹æ–‡æ¡£ä¸­å‡ºç°çš„è¯ï¼‰çš„æ¦‚ç‡ã€‚

		æ–¹æ³•ï¼šğ‘ƒ(ğ¹1â”‚ğ¶)=ğ‘ğ‘–/ğ‘	ï¼ˆè®­ç»ƒæ–‡æ¡£ä¸­å»è®¡ç®—ï¼‰ã€‚

ğ‘ğ‘–ä¸ºè¯¥ğ¹1è¯åœ¨Cç±»åˆ«æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚

Nä¸ºæ‰€å±ç±»åˆ«Cä¸‹çš„æ–‡æ¡£æ‰€æœ‰è¯å‡ºç°çš„æ¬¡æ•°å’Œã€‚

- - ğ‘ƒ(ğ¹1,ğ¹2,â€¦) é¢„æµ‹æ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„æ¦‚ç‡ã€‚

 

ä¾‹å­ï¼š

è®­ç»ƒé›†ç»Ÿè®¡ç»“æœ(æŒ‡å®šç»Ÿè®¡è¯é¢‘)ï¼š

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815112725004-428228733.png)

ç°æœ‰ä¸€ç¯‡è¢«é¢„æµ‹æ–‡æ¡£ï¼šå‡ºç°äº†å½±é™¢ï¼Œæ”¯ä»˜å®ï¼Œäº‘è®¡ç®—ï¼Œè®¡ç®—å±äºç§‘æŠ€ã€å¨±ä¹çš„ç±»åˆ«æ¦‚ç‡ï¼Ÿ

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815112819869-236123281.png)

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815112918495-1825386018.png)

æ€è€ƒï¼šå±äºæŸä¸ªç±»åˆ«ä¸º0ï¼Œåˆé€‚å—ï¼Ÿ

# 3. æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘

é—®é¢˜ï¼šä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¾—åˆ°å¨±ä¹æ¦‚ç‡ä¸º0ï¼Œè¿™æ˜¯ä¸åˆç†çš„ï¼Œå¦‚æœè¯é¢‘åˆ—è¡¨é‡Œé¢æœ‰å¾ˆå¤šå‡ºç°æ¬¡æ•°éƒ½ä¸º0ï¼Œå¾ˆå¯èƒ½è®¡ç®—ç»“æœéƒ½ä¸ºé›¶

è§£å†³æ–¹æ³•ï¼š**æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°**

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815113243042-96607129.png)

ğ›¼ä¸ºæŒ‡å®šçš„ç³»æ•°ä¸€èˆ¬ä¸º1ï¼Œmä¸ºè®­ç»ƒæ–‡æ¡£ä¸­ç»Ÿè®¡å‡ºçš„ç‰¹å¾è¯ä¸ªæ•°

# 4.sklearnæœ´ç´ è´å¶æ–¯å®ç°API

sklearn.naive_bayes.MultinomialNB

sklearn.naive_bayes.MultinomialNB(alpha = 1.0)æœ´ç´ è´å¶æ–¯åˆ†ç±»

alphaï¼šæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ç³»æ•°

# 5. åˆ†ç±»æ¨¡å‹çš„è¯„ä¼°

**(1) å‡†ç¡®ç‡**

estimator.score()
ä¸€èˆ¬æœ€å¸¸è§ä½¿ç”¨çš„æ˜¯å‡†ç¡®ç‡ï¼Œå³é¢„æµ‹ç»“æœæ­£ç¡®çš„ç™¾åˆ†æ¯”ã€‚

**(2) ç²¾ç¡®ç‡å’Œå¬å›ç‡**

- - **æ··æ·†çŸ©é˜µ**

åœ¨åˆ†ç±»ä»»åŠ¡ä¸‹ï¼Œé¢„æµ‹ç»“æœ(Predicted Condition)ä¸æ­£ç¡®æ ‡è®°(True Condition)ä¹‹é—´å­˜åœ¨å››ç§ä¸åŒçš„ç»„åˆï¼Œæ„æˆæ··æ·†çŸ©é˜µ(é€‚ç”¨äºå¤šåˆ†ç±»)

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815185010155-992942323.png)

 

- - **ç²¾ç¡®ç‡**

é¢„æµ‹ç»“æœä¸ºæ­£ä¾‹æ ·æœ¬ä¸­çœŸå®ä¸ºæ­£ä¾‹çš„æ¯”ä¾‹ï¼ˆæŸ¥å¾—å‡†ï¼‰

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815184614672-1647029296.png)

 

- - **å¬å›ç‡**

çœŸå®ä¸ºæ­£ä¾‹çš„æ ·æœ¬ä¸­é¢„æµ‹ç»“æœä¸ºæ­£ä¾‹çš„æ¯”ä¾‹ï¼ˆæŸ¥çš„å…¨ï¼Œå¯¹æ­£æ ·æœ¬çš„åŒºåˆ†èƒ½åŠ›ï¼‰

 ![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815184624382-1838134210.png)

- - **å…¶ä»–åˆ†ç±»æ ‡å‡†**ï¼ŒF1-scoreï¼Œåæ˜ äº†æ¨¡å‹çš„ç¨³å¥å‹

![img](https://images2018.cnblogs.com/blog/964076/201808/964076-20180815184757864-1389733235.png)

 

**(3) åˆ†ç±»æ¨¡å‹è¯„ä¼°API**

sklearn.metrics.classification_report

sklearn.metrics.classification_report(y_true, y_pred, target_names=None)

- - y_trueï¼šçœŸå®ç›®æ ‡å€¼
  - y_predï¼šä¼°è®¡å™¨é¢„æµ‹ç›®æ ‡å€¼
  - target_namesï¼šç›®æ ‡ç±»åˆ«åç§°
  - returnï¼šæ¯ä¸ªç±»åˆ«ç²¾ç¡®ç‡ä¸å¬å›ç‡

# 6. æœ´ç´ è´å¶æ–¯ç®—æ³•æ¡ˆä¾‹

sklearn20ç±»æ–°é—»åˆ†ç±»
20ä¸ªæ–°é—»ç»„æ•°æ®é›†åŒ…å«20ä¸ªä¸»é¢˜çš„18000ä¸ªæ–°é—»ç»„å¸–å­

``` python
# coding=utf-8
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import fetch_20newsgroups
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB
from sklearn.metrics import classification_report
from sklearn.feature_extraction import DictVectorizer
from sklearn.tree import DecisionTreeClassifier, export_graphviz
import pandas as pd


def naviebayes():
    """
    æœ´ç´ è´å¶æ–¯è¿›è¡Œæ–‡æœ¬åˆ†ç±»
    :return: None
    """
    news = fetch_20newsgroups(subset="all")
    # print(news.data)
    # print(news.target)
    # è¿›è¡Œæ•°æ®é›†åˆ†å‰²
    x_train, x_test, y_train, y_test = train_test_split(news.data, news.target, test_size=0.25)
    # print(x_test)
    # å¯¹æ•°æ®é›†è¿›è¡Œç‰¹å¾æŠ½å–
    tf = TfidfVectorizer()
    # å¯¹è®­ç»ƒé›†ä¸­çš„åˆ—è¡¨è¿›è¡Œæ¯ç¯‡æ–‡ç« é‡è¦æ€§ç»Ÿè®¡
    x_train = tf.fit_transform(x_train)
    print(tf.get_feature_names())
    x_test = tf.transform(x_test)
    # è¿›è¡Œæœ´ç´ è´å¶æ–¯ç®—æ³•é¢„æµ‹
    mlt = MultinomialNB(alpha=1.0)
    # print(x_train.toarray())
    mlt.fit(x_train, y_train)
    y_predict = mlt.predict(x_test)
    print("é¢„æµ‹æ–‡ç« ç±»åˆ«ä¸ºï¼š\n", y_predict)
    print("å‡†ç¡®ç‡ä¸ºï¼š\n", mlt.score(x_test, y_test))
    print("æ¯ä¸ªç±»åˆ«çš„ç²¾ç¡®ç‡å’Œå¬å›ç‡\n", classification_report(y_test, y_predict, target_names=news.target_names))


if __name__ == '__main__':
    naviebayes()
```

[![å¤åˆ¶ä»£ç ](https://common.cnblogs.com/images/copycode.gif)](javascript:void(0);)

 

#  7. æœ´ç´ è´å¶æ–¯åˆ†ç±»ä¼˜ç¼ºç‚¹

ä¼˜ç‚¹ï¼š

- æœ´ç´ è´å¶æ–¯æ¨¡å‹å‘æºäºå¤å…¸æ•°å­¦ç†è®ºï¼Œæœ‰ç¨³å®šçš„åˆ†ç±»æ•ˆç‡ã€‚
- å¯¹ç¼ºå¤±æ•°æ®ä¸å¤ªæ•æ„Ÿï¼Œç®—æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¸¸ç”¨äºæ–‡æœ¬åˆ†ç±»ã€‚
- åˆ†ç±»å‡†ç¡®åº¦é«˜ï¼Œé€Ÿåº¦å¿«

ç¼ºç‚¹ï¼š

- éœ€è¦çŸ¥é“å…ˆéªŒæ¦‚ç‡P(F1,F2,â€¦|C)ï¼Œå› æ­¤åœ¨æŸäº›æ—¶å€™ä¼šç”±äºå‡è®¾çš„å…ˆéªŒ
- æ¨¡å‹çš„åŸå› å¯¼è‡´é¢„æµ‹æ•ˆæœä¸ä½³ã€‚